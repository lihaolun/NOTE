# NoSql

- [NoSql](#nosql)
	- [一、分布式](#一分布式)
	- [二、NoSql简介](#二nosql简介)
	- [二、NoSQL数据模型](#二nosql数据模型)
	- [三、NoSQL数据库](#三nosql数据库)
	- [五、分布式数据库中CAP + BASE](#五分布式数据库中cap--base)

## 一、分布式

1）分布式系统

```txt
由多台计算机和通信的软件组件通过计算机网络连接（本地网络或广域网）组成。分布式系统是建立在网络之上的软件系统。正是因为软件的特性，
所以分布式系统具有高度的内聚性和透明性。因此，网络和分布式系统之间的区别更多的在于高层软件（特别是操作系统），而不是硬件。
```

2）分布式计算的优点

```txt
- 可靠性（容错）：
	- 分布式计算系统中的一个重要的优点是可靠性。一台服务器的系统崩溃并不影响到其余的服务器。

- 可扩展性：
	- 在分布式计算系统可以根据需要增加更多的机器。

- 资源共享：
	- 共享数据是必不可少的应用，如银行，预订系统。

- 灵活性：
	- 由于该系统是非常灵活的，它很容易安装，实施和调试新的服务。

- 更快的速度：
	- 分布式计算系统可以有多台计算机的计算能力，使得它比其他系统有更快的处理速度。

- 开放系统：
	- 由于它是开放的系统，本地或者远程都可以访问到该服务。

- 更高的性能：
	- 相较于集中式计算机网络集群可以提供更高的性能（及更好的性价比）。
```

3）分布式计算的缺点

```txt
- 故障排除：
	- 故障排除和诊断问题。

- 软件：
	- 更少的软件支持是分布式计算系统的主要缺点。

- 网络：
	- 网络基础设施的问题，包括：传输问题，高负载，信息丢失等。

- 安全性：
	- 系统的特性让分布式计算系统存在着数据的安全性和共享的风险等问题。
```



## 二、NoSql简介

1）什么是NoSql？

```txt
- NoSql（Not Only SQL），泛指非关系型的数据库。
```

2）NoSQL的适用与不适用场景

- 适用场景

```txt
- 对数据高并发读写
- 海量数据的读写
- 对数据高可扩展性
```

- 不适用场景

```txt
- 需要事务支持
- 基于sql的结构化查询存储，处理复杂的关系，需要即席查询
```

所谓即席查询：用户根据自己的需求，灵活的选择查询条件，系统能够根据用户的选择生成相应的统计报表。

3）传统RDBMS（关系型数据库） VS NOSQL

RDBMS

```txt
- 高度组织化结构数据
- 结构化查询语言
- 数据和关系都存储在单独的表中
- 数据操作语言，数据定义语言
- 严格的一致性
- 基础事务
```

NoSQL

```txt
- 没有声明性查询语言
- 没有预定义的模式
- KV存储，列存储，文档存储，图形数据库
- 最终一致性，而非ACID属性
- 非结构化和不可预知的数据
- CAP定理
- 高性能，高可用性和可伸缩性
```



## 二、NoSQL数据模型

聚合模型

```
- KV值
- Bson（MoagoDB中使用， 是一种类json的一种二进制形式的存储格式）
- 列族 （方便存储结构化和半结构化的数据，方便做数据压缩，对针对某一列或者几列的查询有非常大的优势）
- 图形
```



## 三、NoSQL数据库

- 缓存数据库：Memcache、Redis

```txt
Memcache
- 很早出现的NoSql数据库
- 数据都在内存中，一般不持久化
- 支持简单的key-value模式
- 一般是作为缓存数据库辅助持久化的数据库
```

- 文档数据：mongoDB

```txt
- 数据都在内存中， 如果内存不足，把不常用的数据保存到硬盘
- 虽然是key-value模式，但是对value（尤其是json）提供了丰富的查询功能
- 支持二进制数据及大型对象
- 可以根据数据的特点替代RDBMS ，成为独立的数据库。或者配合RDBMS，存储特定的数据。
```

- 行式数据库
- 列式数据库：HBase、Cassandra



## 五、分布式数据库中CAP + BASE

1）传统的ACID，关系型数据库遵守ACID规则

- A(Atomicity) 原子性

```txt
事务里的所有操作要么全做完，要么都不做，只要有一个操作失败，整个事务就失败，需要回滚。
```

- C(Consistency) 一致性

```txt
一致性是指数据处于一种有意义的状态，一个事务必须使数据库从一个一致性状态变换到另一个一致性状态。比如
账户A转一笔钱到账户B上，如果A上的钱减少了，而B上的钱没有增加，那么此时数据处于不一致状态。
```

- I(Isolation) 独立性

```txt
事务之间不会相互影响
```

- D(Durability)持久性

```txt
一旦事务提交后，它所做的修改将会永久的保存在数据库中，即使出现宕机也不会丢失
```

注意：一致性是基础，也是最终目的，其他三个特性（原子性、隔离性和持久性）都是为了保证一致性的。



2）CAP

```txt
- C(Consistency) 强一致性
- A(Availability) 可用性
- P(Partition tolerance) 分区容错性
```

CAP3进2：CAP3进2理论就是说在分布式存储系统中，最多只能实现上面的两点。而由于当前的网络硬件肯定会出现延迟丢包等问题，所以 分区容忍性是我们必须需要实现的。所以我们只能在一致性和可用性之间进行权衡，没有NoSQL系统能同时保证这三点。

 AP -> 大多数网站架构的选择

```txt
注意：分布式架构的时候必须做出取舍。一致性和可用性之间取一个平衡。多余大多数web应用，其实并不需要强一致性。因此牺牲C换取P，
这是目前分布式数据库产品的方向
```

 CP -> Redis、Mongodb

 CA -> 传统Oracle数据库

![image-20200714211158473](https://gitee.com/wangzj6666666/bigdata-img/raw/master/nosql/image-20200714211158473.png)



3）BASE

BASE是为了解决关系型数据库强一致性引起的问题的可用性降低而提出的解决方案

```txt
- 基本可用（Basically Available）
- 软状态（Soft state）
- 最终一致（Eventually consistent） 
```

它的思想是通过让系统放松对某一时刻数据一致性的要求来换取系统整体伸缩性和性能上改观。为什么这么说呢，缘由就在于大型系统往往由于地域分布和极高性能的要求，不可能采用分布式事务来完成这些指标，要想获得这些指标，我们必须采用另外一种方式来完成，这里BASE就是解决这个问题的办法。





参考相关资料：

https://www.runoob.com/mongodb/nosql.html